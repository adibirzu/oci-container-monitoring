{
  "version": 4,
  "terraform_version": "1.8.4",
  "serial": 62,
  "lineage": "45ad8e27-2ae2-a6e1-0932-dd5991119510",
  "outputs": {
    "agent_install_script_path": {
      "value": "./output/install-agent.sh",
      "type": "string"
    },
    "container_instance_console_url": {
      "value": "https://cloud.oracle.com/compute/container-instances/ocid1.computecontainerinstance.oc1.eu-frankfurt-1.antheljrttkvkkiah3qeohqoro4y7b4roas26wm55ucyljvjcqbjnzavq6da?region=eu-frankfurt-1",
      "type": "string"
    },
    "container_instance_dynamic_group_id": {
      "value": "ocid1.dynamicgroup.oc1..aaaaaaaaqswmk6bi5hkxto3fh6zvykyqtfvprl7np7f4cyexldmx5xq7kmzq",
      "type": "string"
    },
    "container_instance_id": {
      "value": "ocid1.computecontainerinstance.oc1.eu-frankfurt-1.antheljrttkvkkiah3qeohqoro4y7b4roas26wm55ucyljvjcqbjnzavq6da",
      "type": "string"
    },
    "container_instance_name": {
      "value": "monitoring-demo",
      "type": "string"
    },
    "container_instance_state": {
      "value": "ACTIVE",
      "type": "string"
    },
    "container_private_ip": {
      "value": "10.0.0.78",
      "type": "string"
    },
    "container_public_ip": {
      "value": "193.122.57.189",
      "type": "string"
    },
    "deployment_summary": {
      "value": {
        "alarms": null,
        "container_instance": {
          "id": "ocid1.computecontainerinstance.oc1.eu-frankfurt-1.antheljrttkvkkiah3qeohqoro4y7b4roas26wm55ucyljvjcqbjnzavq6da",
          "name": "monitoring-demo",
          "private_ip": "10.0.0.78",
          "public_ip": "193.122.57.189",
          "state": "ACTIVE"
        },
        "logging": null,
        "management_agent": null
      },
      "type": [
        "object",
        {
          "alarms": [
            "object",
            {
              "cpu_alarm": "dynamic",
              "memory_alarm": "dynamic"
            }
          ],
          "container_instance": [
            "object",
            {
              "id": "string",
              "name": "string",
              "private_ip": "string",
              "public_ip": "string",
              "state": "string"
            }
          ],
          "logging": [
            "object",
            {
              "application_log": "dynamic",
              "log_group_id": "dynamic",
              "system_log": "dynamic"
            }
          ],
          "management_agent": [
            "object",
            {
              "config_files_path": "string",
              "install_key_id": "dynamic"
            }
          ]
        }
      ]
    },
    "monitoring_console_url": {
      "value": "https://cloud.oracle.com/monitoring/alarms?region=eu-frankfurt-1\u0026compartmentId=ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq",
      "type": "string"
    },
    "prometheus_config_path": {
      "value": "./output/prometheus-config.yml",
      "type": "string"
    }
  },
  "resources": [
    {
      "module": "module.container_instance",
      "mode": "managed",
      "type": "time_sleep",
      "name": "wait_for_container",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": null,
            "id": "2025-10-28T05:58:31Z",
            "triggers": null
          },
          "sensitive_attributes": [],
          "dependencies": [
            "module.container_instance.data.oci_identity_availability_domains.ads",
            "module.container_instance.oci_container_instances_container_instance.main",
            "module.iam.oci_identity_dynamic_group.container_instance_dg",
            "module.iam.oci_identity_dynamic_group.management_agent_dg",
            "module.iam.oci_identity_policy.container_logging_policy",
            "module.iam.oci_identity_policy.container_resource_policy",
            "module.iam.oci_identity_policy.logging_service_policy",
            "module.iam.oci_identity_policy.mgmt_agent_metrics_policy",
            "module.iam.oci_identity_policy.monitoring_policy",
            "module.management_agent.local_file.agent_config_json",
            "module.management_agent.local_file.agent_install_script",
            "module.management_agent.local_file.prometheus_config",
            "module.management_agent.local_file.service_discovery_config",
            "module.management_agent.oci_management_agent_management_agent_install_key.main",
            "module.management_agent.oci_objectstorage_object.agent_install_script",
            "module.management_agent.oci_objectstorage_object.prometheus_config",
            "module.management_agent.oci_objectstorage_object.service_discovery_config"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "oci_identity_dynamic_group",
      "name": "container_instance_dg",
      "provider": "provider[\"registry.terraform.io/hashicorp/oci\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "compartment_id": "ocid1.tenancy.oc1..aaaaaaaaxzpxbcag7zgamh2erlggqro3y63tvm2rbkkjz4z2zskvagupiz7a",
            "defined_tags": {
              "CCA_Basic_Tag.email": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle_Tags.CreatedBy": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle_Tags.CreatedOn": "2025-10-27T19:59:37.261Z"
            },
            "description": "Dynamic group for container instances to access OCI services",
            "freeform_tags": {
              "CreatedDate": "2025-10-28",
              "Environment": "Development",
              "ManagedBy": "Terraform",
              "Project": "OCI-Container-Monitoring",
              "Terraform": "true"
            },
            "id": "ocid1.dynamicgroup.oc1..aaaaaaaaqswmk6bi5hkxto3fh6zvykyqtfvprl7np7f4cyexldmx5xq7kmzq",
            "inactive_state": null,
            "matching_rule": "ALL {resource.type='computecontainerinstance', resource.compartment.id='ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq'}",
            "name": "monitoring-demo-container-instance-dg",
            "state": "ACTIVE",
            "time_created": "2025-10-27 19:59:37.482 +0000 UTC",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "oci_identity_policy",
      "name": "container_logging_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/oci\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "ETag": "fc74e2a2cdd050060bd4b7a1bf60139c0db806e5",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq",
            "defined_tags": {
              "CCA_Basic_Tag.email": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle-Standard.CostCenter": "Specialists",
              "Oracle_Tags.CreatedBy": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle_Tags.CreatedOn": "2025-10-27T19:59:37.986Z"
            },
            "description": "Policy to allow container instances to write logs",
            "freeform_tags": {
              "CreatedDate": "2025-10-28",
              "Environment": "Development",
              "ManagedBy": "Terraform",
              "Project": "OCI-Container-Monitoring",
              "Terraform": "true"
            },
            "id": "ocid1.policy.oc1..aaaaaaaao6ew2kg4t2el4uvqqublyei7zmjde2lf4t6fsypv6gwldfu63d7a",
            "inactive_state": null,
            "lastUpdateETag": "fc74e2a2cdd050060bd4b7a1bf60139c0db806e5",
            "name": "monitoring-demo-container-logging-policy",
            "policyHash": "f3dff7f57351fdda36fcaa0155b2038c",
            "state": "ACTIVE",
            "statements": [
              "Allow dynamic-group monitoring-demo-container-instance-dg to use log-content in compartment id ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq",
              "Allow dynamic-group monitoring-demo-container-instance-dg to use log-groups in compartment id ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq"
            ],
            "time_created": "2025-10-27 19:59:39.249 +0000 UTC",
            "timeouts": null,
            "version_date": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.iam.oci_identity_dynamic_group.container_instance_dg"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "oci_identity_policy",
      "name": "container_resource_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/oci\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "ETag": "2222627b5ecfa458a35fefc64f1e7791708ce8d1",
            "compartment_id": "ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq",
            "defined_tags": {
              "CCA_Basic_Tag.email": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle-Standard.CostCenter": "Specialists",
              "Oracle_Tags.CreatedBy": "oracleidentitycloudservice/alexandru.birzu@oracle.com",
              "Oracle_Tags.CreatedOn": "2025-10-27T19:59:37.988Z"
            },
            "description": "Policy to allow container instances to access required resources",
            "freeform_tags": {
              "CreatedDate": "2025-10-28",
              "Environment": "Development",
              "ManagedBy": "Terraform",
              "Project": "OCI-Container-Monitoring",
              "Terraform": "true"
            },
            "id": "ocid1.policy.oc1..aaaaaaaa6pr6xlo4qczz6ijixdju77bgbrmpgsjd5yzxlaoovpf2zrcrc34a",
            "inactive_state": null,
            "lastUpdateETag": "2222627b5ecfa458a35fefc64f1e7791708ce8d1",
            "name": "monitoring-demo-container-resource-policy",
            "policyHash": "445a0eccffb1fd8642d7b6a9abfe9236",
            "state": "ACTIVE",
            "statements": [
              "Allow dynamic-group monitoring-demo-container-instance-dg to read metrics in compartment id ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq",
              "Allow dynamic-group monitoring-demo-container-instance-dg to read all-resources in compartment id ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq"
            ],
            "time_created": "2025-10-27 19:59:41.474 +0000 UTC",
            "timeouts": null,
            "version_date": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.iam.oci_identity_dynamic_group.container_instance_dg"
          ]
        }
      ]
    },
    {
      "module": "module.management_agent[0]",
      "mode": "managed",
      "type": "local_file",
      "name": "prometheus_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "# Prometheus Configuration for OCI Management Agent\n# Auto-generated by Terraform\n\nglobal:\n  scrape_interval: 60s\n  scrape_timeout: 10s\n  evaluation_interval: 60s\n\n  external_labels:\n    environment: 'production'\n    region: 'oci'\n    metrics_namespace: 'container_monitoring'\n    container_name: 'monitoring-demo'\n    environment: 'Development'\n\nscrape_configs:\n  - job_name: 'container-monitoring-demo'\n    metrics_path: '/metrics'\n\n    static_configs:\n\n    # Relabel configurations\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: localhost:9090\n\n    # Metric relabeling\n    metric_relabel_configs:\n      - source_labels: [__name__]\n        regex: '(container_.*|process_.*|go_.*)'\n        action: keep\n      - source_labels: [__name__]\n        target_label: oci_namespace\n        replacement: 'container_monitoring'\n\n  # Docker container metrics (if available)\n  - job_name: 'docker'\n    metrics_path: '/metrics'\n    static_configs:\n\n    # Filter for Docker-specific metrics\n    metric_relabel_configs:\n      - source_labels: [__name__]\n        regex: '(container_.*|docker_.*)'\n        action: keep\n\n  # Node exporter metrics (system metrics)\n  - job_name: 'node'\n    metrics_path: '/metrics'\n    static_configs:\n\n    # Keep only relevant system metrics\n    metric_relabel_configs:\n      - source_labels: [__name__]\n        regex: '(node_cpu_.*|node_memory_.*|node_disk_.*|node_network_.*|node_filesystem_.*)'\n        action: keep\n",
            "content_base64": null,
            "content_base64sha256": "XfuhpwGpMTENUtcR79r1JiPw8F0YxApuOmldAbatyU0=",
            "content_base64sha512": "6qYbuCjk1GPV1kZzGwWsAmJHaKpKSG3uze2iHhqeeOT7ATCYCVV0hJakHf0v0EMLQ7rfHMlH37DODm0CDhWhfA==",
            "content_md5": "83b1f1b5fa78cc54cfc8a5c4cacaec32",
            "content_sha1": "e138ec3f14513e969c920509e1c472c5736d7c87",
            "content_sha256": "5dfba1a701a931310d52d711efdaf52623f0f05d18c40a6e3a695d01b6adc94d",
            "content_sha512": "eaa61bb828e4d463d5d646731b05ac02624768aa4a486deecdeda21e1a9e78e4fb0130980955748496a41dfd2fd0430b43badf1cc947dfb0ce0e6d020e15a17c",
            "directory_permission": "0777",
            "file_permission": "0644",
            "filename": "./output/prometheus-config.yml",
            "id": "e138ec3f14513e969c920509e1c472c5736d7c87",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "dependencies": [
            "module.iam.oci_identity_dynamic_group.container_instance_dg",
            "module.iam.oci_identity_dynamic_group.management_agent_dg",
            "module.iam.oci_identity_policy.container_logging_policy",
            "module.iam.oci_identity_policy.container_resource_policy",
            "module.iam.oci_identity_policy.logging_service_policy",
            "module.iam.oci_identity_policy.mgmt_agent_metrics_policy",
            "module.iam.oci_identity_policy.monitoring_policy"
          ]
        }
      ]
    },
    {
      "module": "module.management_agent[0]",
      "mode": "managed",
      "type": "local_file",
      "name": "service_discovery_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/local\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "content": "{\n  \"version\": \"1.0\",\n  \"type\": \"oci_container_instance\",\n  \"service_discovery\": {\n    \"container_instance\": {\n      \"ocid\": \"\",\n      \"private_ip\": \"\",\n      \"metrics_port\": 9090,\n      \"compartment_ocid\": \"ocid1.compartment.oc1..aaaaaaaagy3yddkkampnhj3cqm5ar7w2p7tuq5twbojyycvol6wugfav3ckq\"\n    },\n    \"targets\": [\n      {\n        \"target\": \":9090\",\n        \"labels\": {\n          \"job\": \"container-metrics\",\n          \"instance\": \"\",\n          \"environment\": \"production\"\n        }\n      }\n    ],\n    \"scrape_config\": {\n      \"interval\": \"60s\",\n      \"timeout\": \"10s\",\n      \"metrics_path\": \"/metrics\"\n    }\n  }\n}\n",
            "content_base64": null,
            "content_base64sha256": "Jy9EI9T2jSBniiG8IpUGMUXGDE4TQWGLvRtK42FjQ14=",
            "content_base64sha512": "gwOrqvjOmbSW3dVv4ysDvFeY38+uC5EzAifkd9Is5U150Ta38PEE9o2YOEWXMtEdn1fT3FWt8BelEcxj6dbdNQ==",
            "content_md5": "21212878e8fd429fd316ae44de0b4448",
            "content_sha1": "4e54178fab3db890e1ccb8b0e4b5b2ea8b6ec525",
            "content_sha256": "272f4423d4f68d20678a21bc2295063145c60c4e1341618bbd1b4ae36163435e",
            "content_sha512": "8303abaaf8ce99b496ddd56fe32b03bc5798dfcfae0b91330227e477d22ce54d79d136b7f0f104f68d9838459732d11d9f57d3dc55adf017a511cc63e9d6dd35",
            "directory_permission": "0777",
            "file_permission": "0644",
            "filename": "./output/service-discovery.json",
            "id": "4e54178fab3db890e1ccb8b0e4b5b2ea8b6ec525",
            "sensitive_content": null,
            "source": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "sensitive_content"
              }
            ]
          ],
          "dependencies": [
            "module.iam.oci_identity_dynamic_group.container_instance_dg",
            "module.iam.oci_identity_dynamic_group.management_agent_dg",
            "module.iam.oci_identity_policy.container_logging_policy",
            "module.iam.oci_identity_policy.container_resource_policy",
            "module.iam.oci_identity_policy.logging_service_policy",
            "module.iam.oci_identity_policy.mgmt_agent_metrics_policy",
            "module.iam.oci_identity_policy.monitoring_policy"
          ]
        }
      ]
    }
  ],
  "check_results": [
    {
      "object_kind": "var",
      "config_addr": "module.container_instance.var.container_shape",
      "status": "unknown",
      "objects": [
        {
          "object_addr": "module.container_instance.var.container_shape",
          "status": "unknown"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.container_instance.var.availability_domain",
      "status": "unknown",
      "objects": [
        {
          "object_addr": "module.container_instance.var.availability_domain",
          "status": "unknown"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.container_instance.var.container_memory_gb",
      "status": "unknown",
      "objects": [
        {
          "object_addr": "module.container_instance.var.container_memory_gb",
          "status": "unknown"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.container_instance.var.container_restart_policy",
      "status": "unknown",
      "objects": [
        {
          "object_addr": "module.container_instance.var.container_restart_policy",
          "status": "unknown"
        }
      ]
    },
    {
      "object_kind": "var",
      "config_addr": "module.logging.var.log_retention_days",
      "status": "pass",
      "objects": null
    },
    {
      "object_kind": "var",
      "config_addr": "module.container_instance.var.container_ocpus",
      "status": "unknown",
      "objects": [
        {
          "object_addr": "module.container_instance.var.container_ocpus",
          "status": "unknown"
        }
      ]
    }
  ]
}
